var RichToolbar;RichToolbar=function(){function e(){return this.config=RichConfig.toolbar,this.build()}return e.prototype.build=function(){var e,t,n,i,a,r;for(n=this.config.split(/,/),i=document.createElement("div"),i.classList.add("rich-toolbar"),a=0,r=n.length;r>a;a++)e=n[a],t=document.createElement("div"),t.classList.add(e,"rich-toolbar-item"),t.innerHTML=e,i.appendChild(t);return i},e}();var Rich;new(Rich=function(){function e(){var e,t,n,i;for(this.instances=document.querySelectorAll(".rich"),this.toolbar=new RichToolbar,i=this.instances,t=0,n=i.length;n>t;t++)e=i[t],this.initiate(e);this.addListeners(),this["native"]={b:{command:"bold",type:"native"},hr:{command:"insertHorizontalRule",type:"native"},indent:{command:"indent",type:"native"},ol:{command:"insertOrderedList",type:"native"},ul:{command:"insertUnorderedList",type:"native"},i:{command:"italic",type:"native"},middle:{command:"justifyCenter",type:"native"},full:{command:"justifyFull",type:"native"},left:{command:"justifyLeft",type:"native"},right:{command:"justifyRight",type:"native"},outdent:{command:"outdent",type:"native"},unformat:{command:"removeFormat",type:"native"},all:{command:"selectAll",type:"native"},s:{command:"strikethrough",type:"native"},sub:{command:"subscript",type:"native"},sup:{command:"superscript",type:"native"},u:{command:"underline",type:"native"}},this.fakeNative={background:{command:"backColor",type:"fakeNative",prompt:"Enter a background color"},link:{command:"createLink",type:"fakeNative",prompt:"Enter the URL for the link (needs http://)"},font:{command:"fontName",type:"fakeNative",prompt:"Enter a font name"},fontSize:{command:"fontSize",type:"fakeNative",prompt:"Enter a font size (1-7)"},color:{command:"foreColor",type:"fakeNative",prompt:"Enter a foreground color"},wrap:{command:"formatBlock",type:"fakeNative",prompt:"Enter the html for format the block with"},html:{command:"insertHTML",type:"fakeNative",prompt:"Enter HTML"},image:{command:"insertImage",type:"fakeNative",prompt:"Enter an image URL"},text:{command:"insertText",type:"fakeNative",prompt:"Enter text"}}}return e.prototype.initiate=function(e){return this.createContentEditableArea(e),e.insertAdjacentHTML("afterEnd",this.toolbar.outerHTML),e.style.display="none",this.updateOriginalElement(e)},e.prototype.createContentEditableArea=function(e){var t,n,i;return t=document.createElement("div"),t.setAttribute("contenteditable","true"),t.classList.add("rich-textarea"),n=e.innerHTML,i=n.replace(/&lt;/g,"<"),i=i.replace(/&gt;/g,">"),t.innerHTML=i,e.insertAdjacentHTML("afterEnd",t.outerHTML)},e.prototype.addListeners=function(){var e,t,n,i,a,r,o,c,m;for(i=document.querySelectorAll(".rich-toolbar-item"),a=0,o=i.length;o>a;a++)n=i[a],n.addEventListener("mousedown",function(e){var t;return e.preventDefault(),t=e.current,n=t.classList[0],ToolbarItems[n]&&(n=ToolbarItems[n]),this.handleToolbarItemClick(n)}.bind(this));for(t=document.getElementsByTagName("form"),m=[],r=0,c=t.length;c>r;r++)e=t[r],m.push(e.addEventListener("submit",function(e){var t,i,a,r,o,c,m,s,l;for(s=e.target.children,r=0,c=s.length;c>r&&(n=s[r],n.classList||n.length);r++){if(n.children.length)for(l=n.children,o=0,m=l.length;m>o;o++)t=l[o],t.classList.contains("rich")&&(a=t),t.classList.contains("rich-textarea")&&(i=t);n.classList&&(n.classList.contains("rich")&&(a=n),n.classList.contains("rich-textarea")&&(i=n))}return a.innerHTML=i.innerHTML}));return m},e.prototype.updateOriginalElement=function(e){var t,n;return n=e.nextElementSibling,t=n.nextElementSibling,n.addEventListener("mouseup",this.listenerToUpdateOriginalElement),t.addEventListener("keyup",this.listenerToUpdateOriginalElement),t.addEventListener("keypress",this.forceTagLineBreaks)},e.prototype.listenerToUpdateOriginalElement=function(e){var t,n;return e.preventDefault(),"mouseup"===e.type?(n=e.srcElement.parentNode.nextElementSibling,t=e.srcElement.parentNode.previousElementSibling):"keyup"===e.type&&(n=e.currentTarget,t=e.currentTarget.previousElementSibling.previousElementSibling),n&&t&&t.classList.contains("rich")?t.innerHTML=n.innerHTML:void 0},e.prototype.forceTagLineBreaks=function(e){return 13===e.keyCode?document.execCommand("formatBlock",!1,"p"):void 0},e.prototype.handleToolbarItemClick=function(e){var t;return this.isNative(e)?this.isRealNative(e)?document.execCommand(this["native"][e].command):(t=prompt(this.fakeNative[e].prompt),document.execCommand(this.fakeNative[e].command,!1,t)):document.execCommand(e.command,!1,e.value)},e.prototype.isNative=function(e){return this["native"][e]||this.fakeNative[e]?!0:!1},e.prototype.isRealNative=function(e){return this["native"][e]?!0:!1},e}());